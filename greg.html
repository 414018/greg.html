<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éš¨æ©Ÿåº§ä½ç”¢ç”Ÿå™¨ - çµ‚æ¥µç‰ˆ</title>
    <style>
        :root { --primary: #2c3e50; --accent: #3498db; --bg: #ecf0f1; }
        body { font-family: "PingFang TC", "Microsoft JhengHei", sans-serif; background: var(--bg); padding: 20px; color: #333; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 30px; border-radius: 16px; box-shadow: 0 10px 25px rgba(0,0,0,0.08); }
        h2 { text-align: center; color: var(--primary); margin-bottom: 25px; }
        
        /* è¨­å®šå€å¡Š */
        .setup-card { background: #f8f9fa; padding: 25px; border-radius: 12px; border: 1px solid #dee2e6; }
        
        .control-row { display: flex; flex-wrap: wrap; gap: 20px; margin-top: 15px; }
        .control-group { flex: 1; min-width: 250px; }
        
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #444; }
        textarea, input, select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 15px; }
        textarea { height: 80px; resize: vertical; }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-toggle-group { display: flex; border: 1px solid #ccc; border-radius: 8px; overflow: hidden; }
        .btn-toggle { flex: 1; padding: 10px; border: none; background: #fff; cursor: pointer; transition: 0.2s; font-weight: bold; color: #666; }
        .btn-toggle.active { background: var(--accent); color: white; }
        
        .btn-generate { width: 100%; padding: 16px; background: var(--accent); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 18px; font-weight: bold; margin-top: 25px; transition: 0.3s; }
        .btn-generate:hover { background: #2980b9; transform: translateY(-2px); }

        /* çµæœé¡¯ç¤ºå€ */
        #result-area { margin-top: 30px; padding: 20px; background: #fff; border: 2px solid #eee; border-radius: 12px; overflow-x: auto; position: relative; }
        .screen { width: 60%; max-width: 400px; margin: 0 auto 40px auto; padding: 10px; background: #95a5a6; color: white; text-align: center; border-radius: 0 0 40px 40px; font-size: 14px; letter-spacing: 5px; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }

        /* åº§ä½å®¹å™¨ */
        .seating-chart { 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            padding-bottom: 20px;
            min-width: min-content; /* ç¢ºä¿å…§å®¹ä¸è¢«æ“ å£“ */
        }

        /* ç›´æ’æ¨¡å¼ (Column Mode) */
        .column-container { display: flex; flex-direction: column; gap: 10px; align-items: center; }
        
        /* æ©«æ’æ¨¡å¼ (Row Mode) */
        .row-mode-container { display: flex; flex-direction: column; gap: 15px; width: 100%; align-items: center; }
        .row-container { display: flex; gap: 10px; justify-content: center; }

        .seat { 
            border: 1px solid #bdc3c7; padding: 5px; text-align: center; background: #ebf5fb; 
            border-radius: 6px; font-size: 14px; width: 90px; height: 50px; 
            display: flex; align-items: center; justify-content: center; 
            word-break: break-all; flex-shrink: 0; position: relative;
        }
        .seat.empty { background: #fdfdfd; color: #ddd; border-style: dashed; }
        
        .label-tag { font-size: 14px; font-weight: bold; color: var(--accent); margin-bottom: 5px; }
        .hint { font-size: 12px; color: #7f8c8d; margin-top: 5px; }

    </style>
</head>
<body>

<div class="container">
    <h2>ğŸª‘ éš¨æ©Ÿåº§ä½ç”¢ç”Ÿå™¨ <span style="font-size:0.6em; color:#7f8c8d;">(Pro)</span></h2>
    
    <div class="setup-card">
        <label>1. è¼¸å…¥åå–® (æˆ–ç¯„åœ 1-40)ï¼š</label>
        <textarea id="nameList" placeholder="è¼¸å…¥æ–¹å¼ï¼š&#10;1. è™Ÿç¢¼ç¯„åœï¼š1-40&#10;2. å§“åæ¸…å–®ï¼šæ¯è¡Œä¸€å€‹åå­—"></textarea>

        <div class="control-row">
            <div class="control-group">
                <label>2. é¸æ“‡è‡ªè¨‚æ¨¡å¼ï¼š</label>
                <div class="btn-toggle-group">
                    <button class="btn-toggle" id="btn-mode-row" onclick="setMode('row')">æ©«æ’å®šç¾© (Row)</button>
                    <button class="btn-toggle active" id="btn-mode-col" onclick="setMode('col')">ç›´æ’å®šç¾© (Col)</button>
                </div>
                <div class="hint" id="mode-hint">ç”±å·¦è‡³å³è¨­å®šï¼šç¬¬ä¸€ç›´æ’å¹¾äººï¼Œç¬¬äºŒç›´æ’å¹¾äºº...</div>
            </div>

            <div class="control-group">
                <label>3. äººæ•¸è¨­å®š (ç”¨é€—è™Ÿéš”é–‹)ï¼š</label>
                <input type="text" id="counts" placeholder="ä¾‹å¦‚ï¼š6, 6, 6, 6 (å››å€‹ç›´æ’)">
            </div>
        </div>

        <div class="control-row">
            <div class="control-group">
                <label>4. å¡«å¯«æ–¹å‘ (æ€éº¼å¡äºº)ï¼š</label>
                <select id="fillDirection">
                    <option value="vertical">â¬‡ï¸ å…ˆå¡«æ»¿ä¸€ç›´æ’ (ç¸±å‘å¡«å¯«)</option>
                    <option value="horizontal">â¡ï¸ å…ˆå¡«æ»¿ä¸€æ©«æ’ (æ©«å‘å¡«å¯«)</option>
                </select>
            </div>
        </div>

        <button class="btn-generate" onclick="generateSeats()">ğŸ² ç”¢ç”Ÿåº§ä½è¡¨</button>
    </div>

    <div id="result-area" style="display:none;">
        <div class="screen">è¬›å° / é»‘æ¿</div>
        <div id="chart-container"></div>
    </div>
</div>

<script>
    let currentMode = 'col'; // é è¨­ç‚ºç›´æ’å®šç¾© (å› ç‚ºé€™æ˜¯ä½ çš„éœ€æ±‚)

    function setMode(mode) {
        currentMode = mode;
        document.getElementById('btn-mode-row').className = mode === 'row' ? 'btn-toggle active' : 'btn-toggle';
        document.getElementById('btn-mode-col').className = mode === 'col' ? 'btn-toggle active' : 'btn-toggle';
        
        const hint = document.getElementById('mode-hint');
        const input = document.getElementById('counts');
        
        if (mode === 'col') {
            hint.innerText = "è¨­å®šæ–¹å¼ï¼šç”±å·¦è‡³å³ï¼Œè¼¸å…¥ã€Œæ¯ä¸€æ¢ç›´æ’ã€æœ‰å¹¾å€‹äºº";
            input.placeholder = "ä¾‹å¦‚ï¼š5, 6, 6, 5 (ä»£è¡¨æœ‰4æ¢ç›´æ’)";
        } else {
            hint.innerText = "è¨­å®šæ–¹å¼ï¼šç”±å‰è‡³å¾Œï¼Œè¼¸å…¥ã€Œæ¯ä¸€æ¢æ©«æ’ã€æœ‰å¹¾å€‹äºº";
            input.placeholder = "ä¾‹å¦‚ï¼š5, 6, 6, 5 (ä»£è¡¨æœ‰4æ¢æ©«æ’)";
        }
    }

    function parseNames(input) {
        input = input.trim();
        const rangeMatch = input.match(/^(\d+)\s*-\s*(\d+)$/);
        if (rangeMatch) {
            const start = parseInt(rangeMatch[1]), end = parseInt(rangeMatch[2]);
            const list = [];
            const step = start <= end ? 1 : -1;
            for (let i = start; start <= end ? i <= end : i >= end; i += step) list.push(i + "è™Ÿ");
            return list;
        }
        return input.split('\n').map(n => n.trim()).filter(n => n !== "");
    }

    function shuffle(arr) {
        for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
        }
        return arr;
    }

    function generateSeats() {
        const names = parseNames(document.getElementById('nameList').value);
        const countsStr = document.getElementById('counts').value;
        const counts = countsStr.split(/[,ï¼Œ]/).map(n => parseInt(n.trim())).filter(n => !isNaN(n));
        
        if (names.length === 0) return alert("è«‹è¼¸å…¥åå–®ï¼");
        if (counts.length === 0) return alert("è«‹è¼¸å…¥æ¯æ’/æ¯åˆ—çš„äººæ•¸ï¼");

        const fillDir = document.getElementById('fillDirection').value;
        const container = document.getElementById('chart-container');
        document.getElementById('result-area').style.display = 'block';
        container.innerHTML = "";
        
        let shuffled = shuffle([...names]);

        // è¨ˆç®—æœ€å¤§ç¶­åº¦ï¼Œå»ºç«‹ Grid Map
        let maxCols = 0, maxRows = 0;
        let seatMap = []; // [row][col]

        if (currentMode === 'col') {
            // ç›´æ’å®šç¾©æ¨¡å¼ï¼šcounts = [ç¬¬ä¸€ç›´æ’äººæ•¸, ç¬¬äºŒç›´æ’äººæ•¸...]
            maxCols = counts.length;
            maxRows = Math.max(...counts);
            // å»ºç«‹åœ°åœ–ï¼šå¦‚æœæ˜¯ç›´æ’å®šç¾©ï¼Œæˆ‘å€‘æƒææ¯ä¸€æ¬„(c)ï¼Œåªè¦ row < counts[c] å°±æ˜¯æœ‰æ•ˆåº§ä½
            seatMap = Array.from({ length: maxRows }, (_, r) => 
                Array.from({ length: maxCols }, (_, c) => r < counts[c] ? "" : undefined)
            );
        } else {
            // æ©«æ’å®šç¾©æ¨¡å¼ï¼šcounts = [ç¬¬ä¸€æ©«æ’äººæ•¸, ç¬¬äºŒæ©«æ’äººæ•¸...]
            maxRows = counts.length;
            maxCols = Math.max(...counts);
            // å»ºç«‹åœ°åœ–ï¼šåªè¦ col < counts[r] å°±æ˜¯æœ‰æ•ˆåº§ä½
            seatMap = Array.from({ length: maxRows }, (_, r) => 
                Array.from({ length: maxCols }, (_, c) => c < counts[r] ? "" : undefined)
            );
        }

        // å¡«å…¥åå­—
        let idx = 0;
        if (fillDir === 'horizontal') {
            // æ©«å‘å¡«ï¼šå…ˆå¡« Row 0 (æ‰€æœ‰Col), å†å¡« Row 1...
            for (let r = 0; r < maxRows; r++) {
                for (let c = 0; c < maxCols; c++) {
                    if (seatMap[r][c] === "" && idx < shuffled.length) {
                        seatMap[r][c] = shuffled[idx++];
                    }
                }
            }
        } else {
            // ç¸±å‘å¡«ï¼šå…ˆå¡« Col 0 (æ‰€æœ‰Row), å†å¡« Col 1...
            for (let c = 0; c < maxCols; c++) {
                for (let r = 0; r < maxRows; r++) {
                    if (seatMap[r][c] === "" && idx < shuffled.length) {
                        seatMap[r][c] = shuffled[idx++];
                    }
                }
            }
        }

        // --- æ¸²æŸ“ç•«é¢ ---
        // ç‚ºäº†è®“ä½ æƒ³è¦çš„æ•ˆæœæœ€ç›´è§€ï¼Œæˆ‘ä½¿ç”¨ Flexbox ä¾†ç¹ªè£½
        // å¦‚æœæ˜¯ã€Œç›´æ’å®šç¾©ã€ï¼Œæˆ‘å€‘å°±ä¸€æ¬„ä¸€æ¬„ç•«
        
        container.className = 'seating-chart';
        
        if (currentMode === 'col') {
            // æ¸²æŸ“ç›´æ’ (ç”±å·¦è‡³å³)
            for (let c = 0; c < maxCols; c++) {
                const colDiv = document.createElement('div');
                colDiv.className = 'column-container';
                
                const label = document.createElement('div');
                label.className = 'label-tag';
                label.innerText = `ç›´æ’ ${c + 1}`;
                colDiv.appendChild(label);

                for (let r = 0; r < maxRows; r++) {
                    // æª¢æŸ¥é€™å€‹ä½ç½®æ˜¯å¦åœ¨è¨­å®šç¯„åœå…§ (é¿å…æœªå®šç¾©å€å¡Š)
                    // å¦‚æœè©²ä½ç½®æ˜¯ undefinedï¼Œæˆ‘å€‘æ”¾ä¸€å€‹é€æ˜çš„ä½”ä½ï¼Œä¿æŒå°é½Š
                    if (seatMap[r][c] === undefined && r < counts[c]) { 
                         // é€™è£¡å…¶å¯¦ä¸æœƒç™¼ç”Ÿï¼Œå› ç‚º seatMap æ˜¯æ ¹æ“š counts åˆå§‹åŒ–çš„
                         // ä¸»è¦æ˜¯è™•ç†è¦–è¦ºå°é½Šï¼Œå¦‚æœè©²ç›´æ’äººæ•¸è¼ƒå°‘ï¼Œä¸éœ€è¦ç”¢ç”Ÿä¸‹é¢çš„ div
                    } else if (seatMap[r][c] !== undefined) {
                         const seat = document.createElement('div');
                         const name = seatMap[r][c];
                         seat.className = 'seat' + (name ? '' : ' empty');
                         seat.innerText = name || "ç©ºä½";
                         colDiv.appendChild(seat);
                    }
                }
                container.appendChild(colDiv);
            }
        } else {
            // æ¸²æŸ“æ©«æ’ (ç”±ä¸Šè‡³ä¸‹)
            container.style.flexDirection = 'column';
            for (let r = 0; r < maxRows; r++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'row-container';
                
                // é€™è£¡å¯ä»¥åŠ æ©«æ’æ¨™ç±¤ï¼Œä½†é€šå¸¸å·¦å´æ¨™ç±¤æ¯”è¼ƒé›£æ’ç‰ˆï¼Œé€™è£¡çœç•¥æˆ–ç°¡å–®è™•ç†
                
                for (let c = 0; c < maxCols; c++) {
                    if (seatMap[r][c] !== undefined) {
                        const seat = document.createElement('div');
                        const name = seatMap[r][c];
                        seat.className = 'seat' + (name ? '' : ' empty');
                        seat.innerText = name || "ç©ºä½";
                        rowDiv.appendChild(seat);
                    } else {
                        // æ©«æ’æ¨¡å¼ä¸‹çš„å°é½Šä½”ä½ (å¯é¸)
                    }
                }
                container.appendChild(rowDiv);
            }
        }
    }
</script>

</body>
</html>
